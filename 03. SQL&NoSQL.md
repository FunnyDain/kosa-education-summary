
# SQL

<br>

## 01. DBMS(Database Management System)

- DBê´€ë¦¬ë¥¼ ìœ„í•œ ì»´í“¨í„° ì‹œìŠ¤í…œ
- ìƒìš© ì œí’ˆ
    
    : Oracleì˜ Oracle Database, Microsoftì˜ SQL Server, SYBASEì˜ SYBASE, IBMì˜ DB2
    
- ì˜¤í”ˆ ì†ŒìŠ¤ ì œí’ˆ
: PostgreSQL, MYSQL, MariaDB, CUBRID

> ê´€ê³„í˜•(Relational)ëª¨ë¸
> 
- Key Term
    
    
    | ìš©ì–´  | ëœ» |
    | --- | --- |
    | ë°ì´í„°ë² ì´ìŠ¤(Database) | Relationì˜ ì§‘í•© |
    | ë¦´ë ˆì´ì…˜(Relation) | Tupleì˜ ì§‘í•© |
    | íŠœí”Œ(Tuple) | í…Œì´ë¸”ì˜ Row, Record, ê°€ë¡œ |
    | ì• íŠ¸ë¦¬ë·°íŠ¸(Attribute) | ë¦´ë ˆì´ì…˜ì˜ íŠ¹ì§•ì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ì¼í•œ ë°ì´í„°, ì»¬ëŸ¼, https://www.notion.so/ea9a0dfbec27443dbfdae5e1bc3cde6e |
    | ë„ë©”ì¸(Domain) | DBì—ì„œëŠ” íŠ¹ì • Attributeê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ê°’ì˜ ì§‘í•© |
<br>

---
<br>

## 02. MySQLì„¤ì¹˜

- MySQL Community (GPL) Downloadsë¡œ ì„¤ì¹˜ (.msi)
- custom ì„¤ì¹˜
    
    <img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f934a0c1-ca34-4804-820a-792dd3dc4b59/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230305%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230305T071109Z&X-Amz-Expires=86400&X-Amz-Signature=e502d06d25471a1bd3be7a0865646a3d7c87c85e6bbb2c393b5cb8b608b0a93a&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22Untitled.png%22&x-id=GetObject"/>
    
- password : rootroot

ğŸ’¯ DBMS Client Tools

- MYSQL : Workbench
- TOAD, Orange, SQL Gate for oracle, SQL Developer

<br>

---
<br>

## 03. SQL ë¬¸ë²•

> **primary key & foreign key**
> 
- primary key : ê¸°ë³¸í‚¤, ìë™ indexìƒì„±, ìœ ì¼ì„±, pkê°€ ë  ìˆ˜ ìˆëŠ” í›„ë³´í‚¤ ì¡´ì¬
- foreign key : ì™¸ë˜í‚¤, ê¸°ë³¸í‚¤ë¥¼ ì°¸ê³ í•˜ëŠ” í‚¤, nullê°€ëŠ¥

> **select_ ê²€ìƒ‰**
> 

```sql
select ë³´ì—¬ì¤„ ì—´ or ì „ì²´ *
from í…Œì´ë¸”ëª…
[where ì¡°ê±´]
[group by ì—´_ì´ë¦„]
[having groupì˜ ì¡°ê±´ì‹]
[order by ì—´ì´ë¦„(ì •ë ¬, ê¸°ë³¸ê°’ ASC)]
[limit ìˆ«ì]
```

> **ë°ì´í„° ë³€ê²½**
> 

```sql
-- ë°ì´í„° ì‚½ì…
**insert into í…Œì´ë¸”ëª… (ì—´ ì´ë¦„1, ì—´ì´ë¦„2,â€¦)
insert into í…Œì´ë¸”ëª… (ì—´ ì´ë¦„1, ì—´ì´ë¦„2,â€¦)
selectë¬¸;**    -- ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ì…ë ¥

****-- ë°ì´í„° ìˆ˜ì •
**update í…Œì´ë¸”ëª… 
set ì—´1=ê°’1, ì—´2=ê°’2, â€¦
where ì¡°ê±´;**

-- ë°ì´í„° ì‚­ì œ
**delete from í…Œì´ë¸”ëª… where ì¡°ê±´;**

```

ğŸ’¯ **auto_increment :** ìë™ì¦ê°€, ì§€ì •í•  ë•Œ ê¼­ primary keyë¡œ ì§€ì •í•´ì•¼í•¨

> **ë°ì´í„° íƒ€ì…**
> 
- **ì •ìˆ˜í˜•**
    
    
    | ë°ì´í„° í˜•ì‹ | ë°”ì´íŠ¸ ìˆ˜ | ìˆ«ì ë²”ìœ„ |
    | --- | --- | --- |
    | tinyint | 1 | -128~127 |
    | smallint | 2 | -32,768~32,767 |
    | int | 4 | ì•½ -21ì–µ~+21ì–µ |
    | bigint | 8 | ì•½ -900ê²½ ~+900ê²½ |
    
    **ğŸ’¯ tinyint unsigned** 
    
    - tinyint ë²”ìœ„ë¥¼ -128~127ì—ì„œ ì–‘ì˜ ë²”ìœ„ë¡œ ì˜®ê¸¸ ìˆ˜ ìˆë‹¤. 
    0~255
    - ìŒìˆ˜ë¥¼ ì“¸ í•„ìš”ì—†ì–´ì„œ êµ³ì´ samllintë¥¼ ì“¸ ëŒ€ì•ˆì„ ë§‰ì•„ì¤Œ
- **ë¬¸ìí˜•**
    
    
    | ë°ì´í„° í˜•ì‹ | ë°”ì´íŠ¸ ìˆ˜ |
    | --- | --- |
    | char(ê°œìˆ˜) | 1~255 |
    | varchar(ê°œìˆ˜) | 1~16383 |
    - **charëŠ” ìë¦¿ìˆ˜ê°€ ê³ ì •ê¸¸ì´**
    - **varcharëŠ” ìë¦¿ìˆ˜ê°€ ê°€ë³€ê¸¸ì´**
    
    ğŸ’¯ varcharëŠ” ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìš´ì˜
         but, mysql ë‚´ë¶€ì (ë¹ ë¥¸ ì†ë„)ë©´ì—ì„œëŠ” charë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ good
    
    ğŸ’¯ ë§Œì•½, í…Œì´ë¸”ì— ì „í™”ë²ˆí˜¸ ì»¬ëŸ¼ì´ í¬í•¨ ë ë•Œ, ìˆ«ìë¼ì„œ ì •ìˆ˜í˜•ì„ ì¨ì•¼í•  ê²ƒ ê°™ì§€ë§Œ ë¬¸ìí˜•ì´ ì¢‹ë‹¤. 02, 031ë“± ì•ê¸€ìê°€ 0ìœ¼ë¡œ ì‹œì‘í•˜ì§€ë§Œ ì •ìˆ˜í˜•ìœ¼ë¡œ ì§€ì •í•˜ë©´ 0ì´ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸
    
- **ì‹¤ìˆ˜í˜•**
    
    
    | ë°ì´í„° í˜•ì‹ | ë°”ì´íŠ¸ ìˆ˜ | ì„¤ëª… |
    | --- | --- | --- |
    | float | 4 | ì†Œìˆ˜ì  ì•„ë˜ 7ìë¦¬ê¹Œì§€ í‘œí˜„ |
    | double | 8 | ì†Œìˆ˜ì  ì•„ë˜ 15ìë¦¬ê¹Œì§€ í‘œí˜„ |
- **ë‚ ì§œí˜•**
    
    
    | ë°ì´í„° í˜•ì‹ | ë°”ì´íŠ¸ ìˆ˜ | ì„¤ëª… |
    | --- | --- | --- |
    | date | 3 | ë‚ ì§œë§Œ ì €ì¥, YYY-MM-DD í˜•ì‹ìœ¼ë¡œ ì‚¬ìš© |
    | time | 3 | ì‹œê°„ë§Œ ì €ì¥, HHMMSSí˜•ì‹ìœ¼ë¡œ ì‚¬ìš© |
    | datetime,
    timestamp | 8 | ë‚ ì§œ ë° ì‹œê°„ì„ ì €ì¥,
    YYY-MM-DD HHMMSSí˜•ì‹ìœ¼ë¡œ ì‚¬ìš© |
    | sysdate(),
    now() |  | í˜„ì¬ ë‚ ì§œ |

> **ì—°ì‚°ì**
> 

| ì—°ì‚°ì | ì„¤ëª… |
| --- | --- |
| ë™ë“±ë¹„êµ | = |
| ë¶€ì •ë¹„êµ | <>, != |
| NOT | notì—°ì‚°ì or ! |
| AND,OR | AND,OR or &&,|| |
| ë‚˜ëˆ„ê¸°, ë‚˜ë¨¸ì§€ | /,% |
| ë‘˜ ì¤‘ í•˜ë‚˜ | in |
| ë¬¸ìì—´ ë¶€ë¶„ ê²€ìƒ‰ (â€™ê¹€%â€™) | like |
| ì¡´ì¬ ìœ ë¬´ì— ë”°ë¼ | exists |
| nullì¸ì§€ ê²€ìƒ‰ | is null, is not null |
| ë²”ìœ„ë‚´ | between a and b(ìˆ«ì) /  in(ë¬¸ì) |

âš ï¸ andì˜ ìš°ì„ ìˆœìœ„ê°€ orë³´ë‹¤ ë†’ë‹¤.

âš ï¸ ì‚°ìˆ  â†’ ë¹„êµ â†’ ë…¼ë¦¬ ìš°ì„ ìˆœìœ„

âš ï¸ ìš°ì„ ì ìœ¼ë¡œ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒì„ ê´„í˜¸ë¡œ!

> **ì‘ì„±ìˆœì„œ & ì‹¤í–‰ìˆœì„œ**
> 
- ì‘ì„±ìˆœì„œ
    
    ```sql
    select [all | dsitinct]       -- ì—´ ë¦¬ìŠ¤íŠ¸
    from tableëª…
    where ê²€ìƒ‰ì¡°ê±´
    group by ì—´ë¦¬ìŠ¤íŠ¸ [havingì¡°ê±´, ê·¸ë£¹ì˜ ì¡°ê±´ì´ë‹¤]
    order by ì—´ë¦¬ìŠ¤íŠ¸ [asc(ì˜¤ë¦„ì°¨ìˆœ) | desc(ë‚´ë¦¼ì°¨ìˆœ)]
    ```
    
- ì‹¤í–‰ìˆœì„œ
    
    <aside>
    ğŸ’¡ **************************From â†’ Where â†’ Select â†’ Order by**************************
    
    </aside>
    

<br>

---
<br>


## 04. SQL í•¨ìˆ˜

> **ë¬¸ìì—´ í•¨ìˆ˜**
> 

| í•¨ìˆ˜ | ì„¤ëª… |
| --- | --- |
| function | tì„¤ëª… |
| concat(s1,s2) | ë¬¸ìì—´ ê²½í•© |
| initcap(s) | ì²« ê¸€ìë§Œ ëŒ€ë¬¸ìë¡œ ë³€ê²½ |
| lower(s) | ì†Œë¬¸ìë¡œ ë³€ê²½ |
| upper(s) | ëŒ€ë¬¸ìë¡œ ë³€ê²½ |
| substr(â€™Databaseâ€™,2,4 ) | atab |
| length(s) | ê¸¸ì´ |

> **ìˆ«ì í•¨ìˆ˜**
> 

| í•¨ìˆ˜ | ì„¤ëª… |
| --- | --- |
| abs(n) | ì ˆëŒ€ê°’ |
| ceil(n) | ì˜¬ë¦¼ |
| floor(n) | ë‚´ë¦¼ |
| mod(m,n) | ë‚˜ë¨¸ì§€ |
| power(m,n) | mì˜ nìŠ¹ |
| round(m,n) | ì†Œìˆ˜ì  ì•„ë˜ nìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼ |
| trunc(m,n) | ì†Œìˆ˜ì  ì•„ë˜ nìë¦¬ ë¯¸ë§Œê¹Œì§€ ë²„ë¦¼ |

> **ë‚ ì§œ í•¨ìˆ˜**
> 

| DATE_ADD(ê¸°ì¤€ ë‚ ì§œ, INTERVAL) | ì‹œê°„ ë”í•˜ê¸° |
| --- | --- |
| DATE_SUB(ê¸°ì¤€ ë‚ ì§œ, INTERVAL) | ì‹œê°„ ë¹¼ê¸° |

```sql
í˜„ì¬ ì‹œê°„ì— 1ì´ˆ ë”í•˜ê¸°
SELECT DATE_ADD(NOW(), INTERVAL 1 SECOND);
ê²°ê³¼
2018-01-11 12:00:01

í˜„ì¬ ì‹œê°„ì— 1ë¶„ ë”í•˜ê¸°
SELECT DATE_ADD(NOW(), INTERVAL 1 MINUTE);
ê²°ê³¼
2018-01-11 12:01:00

í˜„ì¬ ì‹œê°„ì— 1ì‹œê°„ ë”í•˜ê¸°
SELECT DATE_ADD(NOW(), INTERVAL 1 HOUR);
ê²°ê³¼
2018-01-11 13:00:00

í˜„ì¬ ì‹œê°„ì— 1ì¼ ë”í•˜ê¸°
SELECT DATE_ADD(NOW(), INTERVAL 1 DAY);
ê²°ê³¼
2018-01-12 12:00:00

í˜„ì¬ ì‹œê°„ì— 1ë‹¬ ë”í•˜ê¸°
SELECT DATE_ADD(NOW(), INTERVAL 1 MONTH);
ê²°ê³¼
2018-02-11 12:00:00

í˜„ì¬ ì‹œê°„ì— 1ë…„ ë”í•˜ê¸°
SELECT DATE_ADD(NOW(), INTERVAL 1 YEAR);
ê²°ê³¼
2019-01-11 12:00:00
```

> **ë³€í™˜ í•¨ìˆ˜ _ íƒ€ì… ë³€í™˜**
> 
1. ì§ì ‘ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë³€í™˜ _ ëª…ì‹œì  ë³€í™˜
    
    ```sql
    **cast (ê°’ as ë°ì´í„°í˜•ì‹[(ê¸¸ì´)])
    convert (ê°’, ë°ì´í„°í˜•ì‹[(ê¸¸ì´)])
    
    select date_format(now(), '%y%m%d');
    select str_to_date('28-11-2022','%d-%m-%y')**
    ```
    
2. ë³„ë„ ì§€ì‹œ ì—†ì´ ìì—°ìŠ¤ëŸ½ê²Œ ë³€í™˜_ ì•”ì‹œì  ë³€í™˜

> **ì§‘ê³„í•©ìˆ˜**
> 
- ì—¬ëŸ¬ í–‰ìœ¼ë¡œë¶€í„° í•˜ë‚˜ì˜ ê²°ê³¼ê°’ì„ ë°˜í™˜
- avg(), count(), max(), min(), sum(), stddev(), variance()

âš ï¸ nullì¸ ë°ì´í„°ëŠ” ì§‘í•© í•¨ìˆ˜ì— ì°¸ì—¬í•˜ì§€ ì•ŠìŒ

<br>

---
<br>


## 05. case & index & join & ì„œë¸Œì¿¼ë¦¬

> **case**
> 

1) ìƒˆë¡œìš´ ì—´ì„ ìƒì„±í•˜ëŠ” ê²½ìš°

```sql
**select case when ê¸°ì¡´ ì—´ = ì¡°ê±´1 then 'ê°’1'
						when ê¸°ì¡´ ì—´ = ì¡°ê±´2 then 'ê°’2'
						...
						(else 'ê°’n') end as ìƒˆë¡œìš´ ì—´**
```

2) ì—´ì„ ì§‘ê³„í•˜ëŠ” ê²½ìš° (ì§‘ê³„ í•¨ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©)
    : ì§‘ê³„ ì—´ì— ì§‘ê³„í•¨ìˆ˜ë¥¼ ì ìš©

```sql
**select ì§‘ê³„í•¨ìˆ˜((distinct) case when ê¸°ì¡´ì—´ 
= ì¡°ê±´ then (elseê°’)end) as ìƒˆë¡œìš´ ì—´**
```

[SQL CASE WHEN êµ¬ë¬¸ ì‚¬ìš©ë²• - ì˜ˆì œë¡œ ì•Œì•„ë³´ê¸°](https://suy379.tistory.com/110)

> **index**
> 
- **ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ëŒ€í•œ ê²€ìƒ‰ ì„±ëŠ¥ì˜ ì†ë„ë¥¼ ë†’ì—¬ì£¼ëŠ” ìë£Œ êµ¬ì¡°**
- ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³„ë„ì´ ì •ë ¬ì—†ì´ ê²°ê³¼ ì¶”ì¶œ ê°€ëŠ¥
- ì¸ë±ìŠ¤ ìƒì„±
    
    ```sql
    CREATE INDEX [ì¸ë±ìŠ¤ëª…] ON [í…Œì´ë¸”ëª…](ì»¬ëŸ¼1, ì»¬ëŸ¼2, ì»¬ëŸ¼3.......);
    EX> CREATE INDEX EX_INDEX ON CUSTOMERS(NAME,ADDRESS); 
    -- UNIQUE í‚¤ì›Œë“œë¥¼ ë¶™ì´ë©´ ì»¬ëŸ¼ê°’ì— ì¤‘ë³µê°’ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»
    EX> CREATE[UNIQUE] INDEX EX_INDEX ON CUSTOMERS(NAME,ADDRESS); 
    
    ALTER TABLE  í…Œì´ë¸”ëª… ADD INDEX(í•„ë“œëª…(í¬ê¸°));
    
    CREATE TABLE í…Œì´ë¸” ëª… ( í•„ë“œëª… ë°ì´í„°íƒ€ì…(ë°ì´í„°í¬ê¸°), INDEX(í•„ë“œëª…(í¬ê¸°)) ENGINE MyISAM;
    ```
    
- ì¸ë±ìŠ¤ ì‚­ì œ
    
    ```sql
    DROP INDEX [ì¸ë±ìŠ¤ ëª…]
    ```
    
- ì¸ë±ìŠ¤ í™•ì¸
    
    ```sql
    SHOW INDEX FROM í…Œì´ë¸”ì´ë¦„
    ```
    

> **Join**
> 
- ì¼ëŒ€ë‹¤ ê´€ê³„ì˜ ì´í•´
    - ë‘ í…Œì´ë¸”ì´ ì¡°ì¸ì„ ìœ„í•´ì„œëŠ” í…Œì´ë¸”ì´ ì¼ëŒ€ë‹¤ (one to many) ê´€ê³„ë¡œ ì—°ê²°ë˜ì•¼í•¨
    
    <aside>
    ğŸ’¡ ì´ë ‡ê²Œ ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” 
    ì£¼ë¡œ **ê¸°ë³¸í‚¤(pk)ì™€ ì™¸ë˜ í‚¤(fk)ê´€ê³„**ë¡œ ë§ºì–´ì ¸ ìˆë‹¤.
    
    </aside>
    
1. **ë‚´ë¶€ ì¡°ì¸**
    
    ```sql
    **select <ì—´ ëª©ë¡>
    from <ì²« ë²ˆì§¸ í…Œì´ë¸”>
    	inner join <ë‘ ë²ˆì§¸ í…Œì´ë¸”>
    	on <ì¡°ì¸ë  ì¡°ê±´>
    [where ê²€ìƒ‰ ì¡°ê±´]**
    ```
    
    ```sql
    use market_db;
    select * 
    from buy
    inner join member
    on buy.mem_id = member.mem_id
    where buy.mem_id = 'GRL';
    
    select * 
    from buy
    inner join member
    on buy.mem_id = member.mem_id;
    
    ```
    
    ğŸ’¯ ë‚´ë¶€ ì¡°ì¸ì˜ í•œê³„ì  
    
    - êµ¬ë§¤ë¥¼ í–ˆë˜ íšŒì›ë“¤ì˜ ì •ë³´ë§Œ ë‚˜ì˜´
    - êµ¬ë§¤ì•ˆí–ˆë˜ íšŒì›ë“¤ì˜ ì •ë³´ë¼ë©´ â€˜êµ¬ë§¤ì•ˆí•¨â€™ ì´ë ‡ê²Œ ë‚˜ì˜¤ê²Œ í•  ìˆ˜ ì—†ìŒ

1. **ì™¸ë¶€ ì¡°ì¸**
- ë‚´ë¶€ ì¡°ì¸ì€ ë‘ í…Œì´ë¸”ì— ëª¨ë‘ ë°ì´í„°ê°€ ìˆì–´ì•¼ ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ë§Œ
- ì™¸ë¶€ ì¡°ì¸ì€ í•œìª½ì—ë§Œ ë°ì´í„°ê°€ ìˆì–´ë„ ê²°ê³¼ê°€ ë‚˜ì˜´

```sql
**select <ì—´ ëª©ë¡>
from <ì²« ë²ˆì§¸ í…Œì´ë¸”(left í…Œì´ë¸”)>
<left or right or full, ê¸°ì¤€> outer join <ë‘ ë²ˆì§¸ í…Œì´ë¸”(right í…Œì´ë¸”)>
on <ì¡°ì¸ë  ì¡°ê±´>
[where ê²€ìƒ‰ ì¡°ê±´];**
```

```sql
select m.mem_id, m.mem_name, b.prod_name, m.addr
	from member m		-- ì™¼ìª½ ê¸°ì¤€, member tableì— ìˆëŠ” ê²ƒì€ ë‹¤ ë‚˜ì™€ë¼
		left outer join buy b		
        on m.mem_id = b.mem_id
	order by m.mem_id;
-- ê·¸ë˜ì„œ ì‡ì§€,ì˜¤ë§ˆì´ê±¸,...ëŠ” êµ¬ë§¤í•œ ê¸°ë¡ì´ ì—†ì§€ë§Œ ì¶œë ¥ë¨
```

1. **ìì²´ ì¡°ì¸**
- ìê¸° ìì‹  ë‘ ê°œì™€ join

```sql
**select <ì—´ ëª©ë¡>
from <í…Œì´ë¸”> ë³„ì¹­a
	inner join <í…Œì´ë¸”> ë³„ì¹­b
	on <ì¡°ì¸ë  ì¡°ê±´>
[where ê²€ìƒ‰ ì¡°ê±´]**
```

```sql
use market_db; 

create table emp_table (
	emp char(4),
    manager char(4),
    phone varchar(8)
);

insert into emp_table values('ëŒ€í‘œ', null, '0000');
insert into emp_table values('ì˜ì—…ì´ì‚¬', 'ëŒ€í‘œ' , '1111');
insert into emp_table values('ê´€ë¦¬ì´ì‚¬', 'ëŒ€í‘œ', '2222');
insert into emp_table values('ì •ë³´ì´ì‚¬', 'ëŒ€í‘œ', '3333');
insert into emp_table values('ì˜ì—…ê³¼ì¥', 'ì˜ì—…ì´ì‚¬', '1111-1');
insert into emp_table values('ê²½ë¦¬ë¶€ì¥', 'ê´€ë¦¬ì´ì‚¬', '2222-1');
insert into emp_table values('ì¸ì‚¬ë¶€ì¥', 'ê´€ë¦¬ì´ì‚¬', '2222-2');
insert into emp_table values('ê°œë°œíŒ€ì¥', 'ì •ë³´ì´ì‚¬', '3333-1');
insert into emp_table values('ê°œë°œì£¼ì„', 'ì •ë³´ì´ì‚¬', '3333-1-1');

-- ê²½ë¦¬ë¶€ì¥ì˜ ì§ì†ìƒê´€ì˜ ì—°ë½ì²˜ë¥¼ ì•Œê³  ì‹¶ë‹¤.
select a.emp "ì§ì›", b.emp "ì§ì†ìƒê´€", b.phone "ì§ì†ìƒê´€ì—°ë½ì²˜"
	from emp_table a
		inner join emp_table b
        on a.manager = b.emp
	where a.emp = 'ê²½ë¦¬ë¶€ì¥';
```

> **ì„œë¸Œì¿¼ë¦¬**
> 

: ì¿¼ë¦¬ ë‚´ë¶€ì— í¬í•¨ë˜ì–´ ìˆëŠ” ì¿¼ë¦¬

<br>

---
<br>


## 04. ì‹¤ìŠµ

- í´ë˜ìŠ¤ë£¸ì— hrìŠ¤í¬ë¦½íŠ¸ ë‹¤ìš´ë¡œë“œ

```sql
use hr;
select *  from employees;
```

> **ERD(Entity Relationship Diagram) ì„¤ê³„**
> 

: Database - Reverse Engineer

> primary keyì¶”ê°€
> 

```sql
alter table job_history
add primary key(employee_id, start_date);
```

> ì„±, ëª…, ê¸‰ì—¬, ì…ì‚¬ì¼ì, ë¶€ì„œë²ˆí˜¸ë¥¼ ì¶œë ¥
> 

```sql
select last_name, first_name, salary, hire_date, department_id
from employees;
```

ğŸ’¯ ë¶€ì„œëª…ë„ ì¶œë ¥ -> join, ì´ ë•Œ ì—°ê²°ê³ ë¦¬ í¬ë¦°í‚¤ë¥¼ ì°¾ì•„ì•¼ í•œë‹¤.

> ì»¤ë¯¸ì…˜ì„ ë°›ëŠ” ì§ì› ì¡°íšŒ commisstion_pct
> 

```sql
#commission_pctì»¬ëŸ½ì´ ë„ì´ (ì•„ë‹Œ) ê²½ìš°ë¡œ ì¡°íšŒ
#is not null or is nullì‚¬ìš©
#<> null or != null or =null ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ ì•ˆëŒ~
select *
from employees
where commission_pct is null;
```

> í•œë²ˆì´ë¼ë„ ë¶€ì„œë‚˜ ì§ë¬´ë¥¼ ë³€ê²½í•œ ì ì´ ìˆëŠ” ì§ì›ì„ ì¡°íšŒ, 
í•œë²ˆì´ë¼ë„ ì£¼ë¬¸í•œ ì ì´ ìˆëŠ”, í•œë²ˆì´ë¼ë„ íœ´í•™í•œ ì ì¸ í•™ìƒ
> 

```sql
ì—¬ëŸ¬ê°€ì§€ ë°©ë²• ì¤‘ exists ì—°ì‚°ìë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.
```

> order by ìˆ«ì(ì»¬ëŸ¼ ìˆœì„œ)
> 

```sql
select *
from employees
where department_id = 70 or department_id = 80 and last_name like 'K%'
order by 1 desc
;
```

<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/579a69f5-609b-46d2-8705-6a8609860ccc/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230305%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230305T071250Z&X-Amz-Expires=86400&X-Amz-Signature=ee623b02e0b03118a548f65156ba3c980ef5fc4921b3519713dddbf55f635b8f&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22Untitled.png%22&x-id=GetObject"/>

> ë¬¸ì í•¨ìˆ˜
> 

```sql
ì´ë©”ì¼ ì£¼ì†Œ ì¤‘ kosa.go.krì„ ë„£ì–´ì„œ => concat
ì´ë©”ì¼ ì£¼ì†Œ ì¤‘ 5ìë¦¬ë§Œ => substr
```

> ìˆ«ì í•¨ìˆ˜
> 

```sql
#12345.678
select 12345.678, round(12345.678,2), round(12345.678,-2);
```

> ë‚ ì§œ í•¨ìˆ˜
> 

```sql
select now(), sysdate();

#ì˜¤ëŠ˜ë¶€í„° 100ì¼ í›„
#ì˜¤ëŠ˜ë¶€í„° 1ë…„ í›„, ì…ì‚¬í›„ 30ì£¼ë…„ì¼ì
#ë‘ ë‚ ì§œ ì‚¬ì´ë¥¼ ì—°ì‚°(ex) ì…ì‚¬í›„ ê·¼ì†ë…„ìˆ˜)

select now(), date_format(now(), '%m-%d-%y');
select last_name, hire_date, date_format(hire_date, '%m-%d-%y') ì…ì‚¬ì¼ì
from employees;
```

> ê¸°íƒ€
> 

```sql
#ì—°ë´‰ì„ ì¶œë ¥, ë‹¨ ì»¤ë¯¸ì…˜ì„ ë°˜ì˜í•˜ì—¬
select salary, commission_pct, salary*(1 + ifnull(commission_pct,0)) ì»¤ë¯¸ì…˜ë°˜ì˜ê¸‰ì—¬,
last_name 
from employees;
```

> ì„œë¸Œì¿¼ë¦¬
> 
- Steven, Kingì´ ê·¼ë¬´í•˜ëŠ” ë¶€ì„œì˜ ë¶€ì„œì› ì •ë³´ë¥¼ ì¶œë ¥
    
    ```sql
    select department_id from employees where last_name = 'king' and first_name = 'Steven';		#90ë‚˜ì˜´
    select *
    from employees
    where department_id = 90;
    ```
    

- ì´ ë‘˜ì„ ì„œë¸Œì¿¼ë¦¬ë¡œ êµ¬í˜„
    
    ```sql
    select *
    from employees
    where department_id = (select department_id 
    						from employees 
    						where last_name = 'king' and first_name = 'Steven');
    ```
    

- ê·¸ ë°–ì—
    
    ```sql
    
    select commission_pct from employees;
    
    select count(*), count(department_id) from employees;
    
    select department_id, count(*)
    from employees
    group by department_id;
    
    #ë¶€ì„œë³„ ì¸ì›ìˆ˜ ì¶œë ¥í•˜ëŠ”ë° 1ëª… ì´í•˜ëŠ” ì œì™¸í•¨
    #ê¸‰ì—¬ê°€ 5000ì´ìƒë§Œ ë°˜ì˜
    
    select department_id, count(*)
    from employees
    -- where count(*) < 1
    group by department_id
    having count(*) > 1;
    
    select last_name, salary,
    	case when salary < 5000 then 'D'
    		when salary < 7000 then 'C'
            when salary < 10000 then 'B'
            when salary < 15000 then 'A'
            else 'S'
    	end sal_grade
    from employee;
    
    select
    	case when salary < 5000 then 'D'
    		when salary < 7000 then 'C'
            when salary < 10000 then 'B'
            when salary < 15000 then 'A'
            else 'S'
    	end sal_grade,
        count(*) cnt
    from employees
    group by(case when salary < 5000 then 'D'
    		when salary < 7000 then 'C'
            when salary < 10000 then 'B'
            when salary < 15000 then 'A'
            else 'S'
    	end), (case when salary < 5000 then '5'
    		when salary < 7000 then '4'
            when salary < 10000 then '3'
            when salary < 15000 then '2'
            else '1'
    	end)
    order by (case when salary < 5000 then '5'
    		when salary < 7000 then '4'
            when salary < 10000 then '3'
            when salary < 15000 then '2'
            else '1'
    	end);
    
    # ì…ì‚¬ì¼ìê°€ ê°€ì¥ ë¹ ë¥¸ ì§ì› 3ì‚¬ëŒì„ ì¶œë ¥, ê¸‰ì—¬ê°€ ê°€ì¥ ì‘ì€ 3ëª…ì„ ì¶œë ¥
    select * from employees order by hire_date asc limit 3;
    
    # ì„±, ì…ì‚¬ì¼ì, ê¸‰ì—¬, ë¶€ì„œëª… ì¶œë ¥
    # ì¡°íšŒí•  ë°ì´í„°ê°€ ë‘ ê°œì˜ í…Œì´ë¸”
    # d.department_id ë™ì¼í•œ ì»¬ëŸ¼ì´ë¯€ë¡œ ì–´ë”” í…Œì´ë¸”ì¸ì§€ ëª…ì‹œë¥¼ í•´ì•¼í•¨
    # ì•„ì§ ë¶€ì„œì— ë°°ì¹˜ë˜ì§€ ì•Šì•„ì„œ ë¶€ì„œëª…ì„ ì¶œë ¥í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ëŠ” ì‚¬ë¼ì§„ë‹¤. => outer join
    
    select e.last_name, e.hire_date, e.salary, d.department_name, d.department_id 
    from employees e left JOIN departments d
    	on e.department_id = d.department_id;
    
    # ì•„ì§ ë¯¸ë°°ì¹˜ ìƒíƒœì˜ ì§ì›ì€ ë¶€ì„œëª…ì—†ìŒì´ë¼ê³  ì¶œë ¥í•˜ì‹œì˜¤
    select last_name, salary, ifnull(d.department_name,'ë¶€ì„œëª…ì—†ìŒ')
    from employees e left JOIN departments d
    	on e.department_id = d.department_id;
        
    #self_joinì‚¬ìš©í•˜ëŠ” ê²½ìš°
    #ê´€ë¦¬ì ì´ë¦„ë„ ì¶œë ¥
    select e.last_name, m.last_name
    from employees e join employees m on e.manager_id = m.manager_id;
    
    #Steven, Kingì´ ê·¼ë¬´í•˜ëŠ” ë¶€ì„œì˜ ë¶€ì„œì› ì •ë³´ë¥¼ ì¶œë ¥
    select department_id from employees where last_name = 'king' and first_name = 'Steven';		#90ë‚˜ì˜´
    select *
    from employees
    where department_id = 90;
    
    #ì´ ë‘˜ì„ ì„œë¸Œì¿¼ë¦¬ë¡œ êµ¬í˜„
    select *
    from employees
    where department_id = (select department_id 
    						from employees 
    						where last_name = 'king' and first_name = 'Steven');
    
    #= x, in o
    select *
    from employees
    where department_id in (select department_id 
    						from employees 
    						where last_name = 'king');
    
    #ë¶€ì„œë³„ë¡œ ìµœê³  ê¸‰ì—¬ë¥¼ ë°›ëŠ” ì§ì›ì •ë³´ ì¡°íšŒ
    #ë‹¤ì¤‘ì»¬ëŸ¼
    select max(salary) from employees group by department_id;
    select * 
    from employees
    where (salary, department_id) in (select max(salary), department_id from employees group by department_id)
    order by 3;
    
    #ìê¸° ë¶€ì„œì˜ í‰ê· ê¸‰ì—¬ë³´ë‹¤ ë§ì€ ê¸‰ì—¬ë¥¼ ë°›ëŠ” ì§ì›ì¡°íšŒ
    #ìƒí˜¸ì—°ê´€ì„œë¸Œì¿¼ë¦¬
    select * 
    from employees e
    where salary > (select avg(salary) from employees where department_id = e.department_id);
    
    #ìŠ¤ì¹¼ë¼ ì„œë¸Œ ì¿¼ë¦¬
    
    #ìê¸°ë¶€ì„œì˜ í‰ê· ê¸‰ì—¬ë„ ì¶œë ¥
    select last_name, salary, department_id,
    round((select avg(salary) from employees where department_id = e.department_id)) ë¶€ì„œí‰ê· ê¸‰ì—¬
    from employees e;
    
    #fromì ˆì˜ ì„œë¸Œì¿¼ë¦¬
    #ìì‹ ì˜ ë¶€ì„œ í‰ê· ê¸‰ì—¬ë³´ë‹¤ ë§ì€ ê¸‰ì—¬ ë°›ëŠ” ì‚¬ì› ì¡°íšŒ
    #ë¶€ì„œë³„ í‰ê· ê¸‰ì—¬ë¥¼ fromì ˆì˜ ì„œë¸Œì¿¼ë¦¬ë¡œ ì²˜ë¦¬
    select * 
    from employees e join (select department_id, avg(salary) avg_salary
    from employees
    group by department_id) da on e.department_id = da.department_id
    where e.salary > da.avg_salary;
    
    #kë¡œ ì‹œì‘ë˜ëŠ” ì´ë¦„ ì‚¬ì›ì¡°íšŒ
    #indexìƒì„±
    select *
    from employees
    where last_name like 'k%';
    create index emp_last_name_idx on employees(last_name);
    drop index emp_last_name_idx on employees;
    show index from employees;
    
    -- ê³¼ì œ
    
    ```
    

- êµìˆ˜ë‹˜ í’€ì´
    
    ```sql
    -- 1. ë¶€ì„œë²ˆí˜¸, ë¶€ì„œëª…, ë¶€ì„œì¥ì‚¬ë²ˆ, ë¶€ì„œì¥ì„±ëª…, ë¶€ì„œì¥ì…ì‚¬ì¼ìë¥¼ ì¶œë ¥í•˜ì‹œì˜¤.
    -- - ë‹¨ ë¶€ì„œì¥ì´ ì—†ìœ¼ë©´ ë¶€ì„œì¥ì—†ìŒìœ¼ë¡œ ì¶œë ¥
    
    select d.department_id, d.department_name, ifnull(e.employee_id, 'ë¶€ì„œì¥ì—†ìŒ'), ifnull(e.last_name, 'ë¶€ì„œì¥ì—†ìŒ'), ifnull(e.first_name, 'ë¶€ì„œì¥ì—†ìŒ'), ifnull(e.hire_date, 'ë¶€ì„œì¥ì—†ìŒ')
    from employees e right join departments d on e.employee_id = d.manager_id;
    
    -- 2. ìì‹ ì˜ ê´€ë¦¬ìë³´ë‹¤ ë¨¼ì € ì…ì‚¬í•œ ì§ì›ì˜ ì‚¬ë²ˆ, ì„±ëª…, ì…ì‚¬ì¼ì, ê´€ë¦¬ìì…ì‚¬ì¼ìë¥¼ ì¶œë ¥í•˜ì‹œì˜¤.
    select e.employee_id, e.last_name, e.first_name, e.hire_date, m.hire_date
    from employees e join employees m on e.manager_id = m.employee_id
    where e.hire_date < m.hire_date;
    
    -- 3. Seattleì— ê·¼ë¬´í•˜ëŠ” ì§ì›ì˜ ì‚¬ë²ˆ, ì„±ëª…, ì…ì‚¬ì¼ì, ë¶€ì„œë²ˆí˜¸, ë¶€ì„œëª…ì„ ì¶œë ¥
    -- - ë‹¨ ì„œë¸Œì¿¼ë¦¬ë¡œ í•©ë‹ˆë‹¤.
    select e.last_name, e.hire_date, e.department_id, 
    (select department_name from departments where department_id = e.department_id) dept_name
    from employees e
    where department_id in (select department_id
    						from departments
                            where location_id in (select location_id
    											 from locations
                                                 where city = 'Seattle'));
    ```
    
<br>

---
<br>

# NoSQL

<br>

## 01. ì •ì˜

- ë°ì´í„° ëª¨ë¸ì„ ë‹¨ìˆœí™” í•´ì„œ 
ê´€ê³„í˜• ë°ì´í„°ëª¨ë¸ê³¼ sqlë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ëª¨ë“  DBMS or ë°ì´í„° ì €ì¥ ì¥ì¹˜
- í›¨ì”¬ í° ìš©ëŸ‰ì˜ ë°ì´í„° ì²˜ë¦¬ê°€ í•„ìš”í•¨ì— ë”°ë¼ ìƒì„±
- ë¹„ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì§€ì¹­í•˜ëŠ” ë° ì‚¬ìš©

> íŠ¹ì§•
> 
- ìŠ¤í‚¤ë§ˆ x, í´ëŸ¬ìŠ¤íŠ¸ ì‹¤í–‰ ê°€ëŠ¥, ì¼ê´€ì„±ì„ í¬ìƒí•˜ì—¬ ë‹¤ë¥¸ ì†ì„±ì„ ì–»ëŠ”ë‹¤.
- sql ì§ˆì˜ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
- ê· ì¼í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ë‚˜ ì»¤ìŠ¤í…€ í•„ë“œë¥¼ ë‹¤ë£° ë•Œ ìœ ìš©

<br>

---
<br>

## 02. MongoDB

- ê´€ê³„DBì™€ key-value ë¶„ì‚° ì €ì¥ ì‹œìŠ¤í…œì˜ ì¥ì ì„ í†µí•©í•œ db
- ë¯¸ë¦¬ ì •í•´ì§„ ìŠ¤í‚¤ë§ˆê°€ ì¡´ì¬ í•˜ì§€ ì•ŠìŒ

> ë¬¸ì„œ êµ¬ì„±
> 
- Collection : ë°ì´í„° ì €ì¥ ì¥ì†Œ
- íƒœê·¸ : êµ¬ë¶„ì
- Meta Data : êµ¬ì¡°í™”ëœ ì •ë³´ë¥¼ ë‹¤ë£¸
- ë””ë ‰í† ë¦¬ êµ¬ì¡°
- ë²„í‚· : í•˜ë‚˜ì˜ ì£¼ì†Œë¥¼ ê°–ëŠ” íŒŒì¼ì˜ í•˜ë‚˜ì˜ êµ¬ì—­
- Database - collection - document

<br>

---
<br>

## 03. MongoDB ëª…ë ¹ì–´

> **ì‰˜ ê¸°ë³¸**
> 
- ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë°©ì‹ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•, í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ _ jsoní˜•íƒœ

| ëª…ë ¹ì–´ | ì„¤ëª… |
| --- | --- |
| show dbs | ëª¨ë“  dbì¶œë ¥ |
| show collections | ì»¬ë ‰ì…˜ì˜ ëª©ë¡ ì¶œë ¥ |
| db.stats() | í•˜ë‚˜ì˜ dbì— ëŒ€í•´ ìƒì„¸ ì •ë³´ ì¶œë ¥ |
| db.numbers.stats() | í•˜ë‚˜ì˜ ì»¬ë ‰ì…˜ì— ëŒ€í•œ ìƒì„¸ ì •ë³´ ì¶œë ¥ |
| use users | users ì½œë ‰ì…˜ ì‚¬ìš©í•˜ê¸°, ì—†ìœ¼ë©´ ìƒì„± |
| db.users.insert({jsoní˜•íƒœì˜ ë°ì´í„°}) | ë¬¸ì„œ ìƒì„±í•˜ê¸° |
| db.users.find() | ìƒì„±ëœ ë¬¸ì„œ ì¡°íšŒí•˜ê¸° |

> **CRUD**
> 
- create
    
    ```sql
    insert()
    insertOne()
    insertMany()
    ```
    
- Retrieve()
    
    ```sql
    find(filter, options)
    findOne(filter, options)
    ```
    
- Update()
    
    ```sql
    update(query, update, options)
    updateOne(filter, data, options)
    updateMany(filter, data, options)
    ```
    
- Delete
    
    ```sql
    deleteOne(filter, options)
    deleteMany(filter, options)
    ```
    

<br>

---
<br>


## 04. MongoDB ì„¤ì¹˜

- ì„¤ì¹˜
    
    ```sql
    C:\Users\COM>mongo
    ```
    
- compassëŠ” pass
- cmd â‡’ êµ‰ì¥íˆ ìœ ì—°í•˜ë‹¤ëŠ” ì¥ì 
- mongodb database tools download - ****MongoDB Command Line Database Tools Download****
    - ì»¤ë“œ ë¼ì¸ ìœ í‹¸ë¦¬í‹°
    - json,csvíŒŒì¼ì„ import, exportê°€ëŠ¥
- viscodeì—ì„œ nodeì„¤ì¹˜ í›„ ëŒë ¤ë³´ê¸° ì‹¤ìŠµ
    - node.jsì—ì„œ mongoDBì— ê´€ë ¨í•œ ëª¨ë“ˆì„ npmìœ¼ë¡œ ì„¤ì¹˜í•˜ê³  ì ‘ì†ê°€ëŠ¥

<br>

---
<br>


## 05. ê²€ìƒ‰

> aggregate
> 
- find()ëŒ€ì‹  ì§‘í•© ê²€ìƒ‰
- db.collection.aggregate(pipeline, option)

> **index**
> 
- ìƒì„± : db.collections.createIndex(key, options)
- ì¡°íšŒ : db.collections.getIndexes()
- ì‚­ì œ : db.collections.dropIndex(idx_name)